# SyncCraft - 一个后台文件同步的程序

# 预告

# 更新历史

## 1.9.4-beta1（2025-04-06 发布）

- :lipstick: 换用更高清的图标
- :art: 使用更好的异常显示功能
- :bug: 修复使用临时身份『以管理员权限运行』时报错

## 1.9.3（2025-04-03 发布）

- :fire: pk_gui.py 菜单中移除『终端执行任意命令\(system\)』选项，因为使用该函数经常会莫名其妙地出现错误。
- :fire: 进一步移除『日志自动滚屏』的功能，预计在程序全部改写 by PyQt 之后重新加入。
- :fire: 移除一些过时的代码如 `record_register_old`。
- :art: 现在使用更好的 NTFS 安全权限保护的方法，添加『强制模式』可选项。
- :art: record_register 增加『`multiline`（多行模式）』参数，默认关闭，1.9.2 之前的版本记录日志默认为多行。
- :rocket: 菜单栏微调。
- :sparkles: 『使用临时身份』勾选后，关闭时会自动删除实例产生的所有文件。
- :construction: PyQt 改写中. . . . . .

## 1.9.2（2025-03-10 发布）

**1.10 版本计划用 pyQt6 全面改写 GUI 框架**

- :construction: 不再允许用户自行选择『日志自动滚屏』，默认开启。
- :bug: 新创建同步根目录时，因部分配置文件缺省而报 KeyError 错误的问题。
- :sparkles: 『检查更新』可以自行选择更新到正式版还是测试版。

## 1.9.2-beta2（2025-03-09 发布）

**1.10 版本计划用 pyQt6 全面改写 GUI 框架**

- :art: 计划移除自动滚屏按钮（以后强制自动滚屏）
- :sparkles: 自主选择工作目录
- :bug: 修复托盘图标在程序退出后无法自行消失，仍留在托盘中的 bug

## 1.9.2-beta1（2025-03-03 发布）

- :bug: 修复资源文件路径错误的 bug
- :art: 修正部分间接导入模块的问题

## SyncCraft 1.9.1（2025-03-02 发布）

- :fire: Deleted: 移除 `file_op.py`
- :art: 修改『今日人品』的生成代码
- :heavy_minus_sign: 移除对 win32process 的依赖
- :heavy_minus_sign: 移除对 getpass 的依赖
- :heavy_minus_sign: 移除对 socket 的依赖
- :bug: 在『编辑配置文件』中，将 disabledWhenSubWindow 将 true 改为 false 时，保存并返回窗口时，会使主窗口再也无法获得响应。
- :sparkles: 用户可以自定义设置工作目录
- :wrench: 在线更新加入『gh-pages』打开页面并在更新内容之后紧跟『下载链接』

## SyncCraft 1.9.0（2025-03-01 发布）

**破坏性更新**

修正日志格式，代码风格

- Modified: 启动界面的 GUI
- Modified: 导出配置文件的默认文件名
- Fixed: 修正“以管理员权限运行”函数时，报 Failed to Remove Temporary Directory... 警告
- Deleted: 移除对 pyperclip, wmi 的依赖
- Deleted: 移除用 win32api 写的 topmost_st 函数，移除对 pythoncom, win32con, win32gui, win32com 的依赖
- Modified: 移除启动界面的“启动完成后退出”文本框

## SyncCraft 1.8.1（2025-02-01 发布）

### pk_gui.py

1. 更新窗口置顶的函数
2. 日志窗口改为 tk.Text
3. 完成右键弹出菜单的“复制”功能
4. 增设“全局设置”

## SyncCraft 1.8（2025-01-26 发布）

### pk_gui.py

1. 更新“执行任意命令的图形界面”
2. 联网获取更新
3. “基础设置”界面全面改版（实验性设置）

### pk.py

1. 修正“运行”模块中生成器 `run_until()` 错误调用的 bug

## SyncCraft 1.7.3（2024-12-20 发布）

### pk_gui.py

1. “运行”模块现在可以暂停和终止啦！
2. 优化“基础设置”的图形界面

### pk.py

1. \[WIP\]加入“文件列表”黑白名单机制

## SyncCraft 1.7.2（2024-12-07 发布）

### pk_gui.py

1. 自动移除黑白名单中的空值
2. 修复 1.7.1 以下版本中的基础设置中，bw_list 编辑时若以空值保存，则会在列表中添加一个空字符串的 bug

## ShadowCraft 1.7.1（2024-12-03 发布）

### pk_gui.py

1. 修正顺序输出反而倒序，倒序输出顺序的 bug
2. 更新编辑黑白名单设置

### pk.py

1. 更新黑白名单机制

## ShadowCraft 1.7.0 Release（2024-12-01 发布）

### pk_gui.py

1. 多线程实现可终止的同步（但目前还无法暂停）
2. 修复基础设置的一些 bug
3. tr_sysTerminal 模板加入 initialvalue 参数
4. 继续更新基础设置

### pk.py

1. 更新日志记录相关的代码
2. 加入卷标黑/白名单制

## ShadowCraft 1.6.0 Release（2024-11-03 发布）

1.6.0 是一次破坏性更新，1.5 及以下的版本不兼容 1.6 以上的配置文件

### pk.py

1. peek 多个文件夹时：对于不存在的源文件夹，不再创建与之对应的目标文件夹。
2. \[驱动器的同步增强\]两次 peek() 之间会主动检测一次同步的硬盘序列号，当发现序列号不一致时（程序休眠时，硬盘被拔出并插上了一个新的硬盘）
3. 添加版本提示 `__ver__` 键值对
4. 更新存档管理

### pk_gui.py

1. 添加“快速锁定该目录”和“解锁该目录”
2. 修复子窗口抢夺焦点时覆盖父窗口失去焦点时的设置
3. 将文件夹同步生成的存档与用户手动添加的存档分离，前者保存在 `self.cursor[i]["archives"]` 中，后者则保存在
   self.synced_archives 中

## ShadowCraft 1.5.0 Release

### pk_gui.py

1. 完善注销功能
2. 添加“打开同步根目录”、“打开 Terminal 终端”

## ShadowCraft 1.5-Beta4（2024-09-20 发布）

### ShadowCraft.py

统计启动用时

### pk_gui.py

1. 给日志加入横向滚动条
2. 优化注销实例的界面
3. 显示接收的参数
4. 创建窗口时移动至屏幕中央

## ShadowCraft 1.5-Beta3（2024-09-19 发布）

### pk_gui.py

1. 删除实例：如果用户中途点击“取消”，后续无法正常记录日志。
2. 优化“查阅存档”功能，当用户双击时自动打开存档文件夹。

### pk.py

1. 日志记录时间方式由时间戳改为 user-friendly-time.
2. 在不支持 NTFS 的卷上，弹出“不支持NTFS安全权限”提示
3. 修正 1.5-Beta1 文件复制错误的问题

## ShadowCraft 1.5-Beta2（2024-09-17 发布）

### ShadowCraft.py

1. 使用 --onefile 参数打包
2. 添加 pk_misc.py 辅助文件

### pk_gui.py

1. 加入“注销实例”功能
2. 加入 style 样式
3. 加入“导出日志”功能
4. 运行加入滚动条
5. 调整优化代码结构

## ShadowCraft 1.5-Beta1（2024-09-15 发布）

### ShadowCraft.py

使用 globalsettings.pk_json 存储全局设置

### pk_gui.py

1. 用 tkinter.ttk 改写 Button, Checkbutton, Entry, Radiobutton, ScrollBar and Spinbox 6 个组件
2. 添加记录全局日志的功能，实例自身的日志存储在同步的根目录下的 \_\_Logs\_\_ 文件夹下
3. 优化、完善一些功能

### pk.py

更新配置文件存储位置：根目录下

## ShadowCraft 1.4.4 ESR（2024-09-14 发布）

重命名 pk_main.py -> ShadowCraft.py

### ShadowCraft.py

1. 选择文件夹现在支持参数设置了
2. 修改“选择文件夹”的图形界面

### pk_gui.py

1. 更新“检查已绑定的按键”图形界面
2. 禁用主窗口上两个空位按钮
3. 主窗口中加入右键菜单
4. 添加“清除历史记录”模块

## pk 1.4.4-Beta1（2024-09-13 发布）

### pk_main.py

1. 加入选择同步根目录的窗口

### pk_gui.py

1. 修正不论“自动滚屏”是否设置为 True，都会滚屏的 bug。
2. “百宝箱”菜单条的颜色现在每次打开时可以更换了
3. 更新 sysTerminal 图形界面模板，加入滚动条
4. 补充快捷键
5. 修正若干 bug

### pk.py

修正以管理员权限运行时错误文件的问题

## pk 1.4.3（2024-09-05 发布）

创建 pk_main.py 文件，存储主脚本  
pk_gui.py 只作为一个包，被 pk_main 导入

### pk_gui.py

1. 更新弹出窗口的预览图标
2. 加入“附加存档”和“解除关联存档”的功能
3. 更新按键绑定有关的代码

### pk.py

修正 userdata 被记录到 conf_config 根下的 bug

## pk 1.4.3-beta1（2024-09-04 发布）

### pk_gui.py

1. 在“百宝箱”中添加“get_md5”模块
2. 修正 /forever 弹出窗口时间过长的问题
3. 修正子窗口调用 topmost_tm 会触发两个窗口互相夺取焦点的 bug
4. 修正子窗口在 take_focus = False 时无法夺取根窗口的焦点的 bug

### pk.py

1. 修正以非管理员权限运行会在保护根目录上报错的问题
2. 修正无法自动保存存档的问题。

## pk 1.4.2（2024-09-02 发布）

由于学业原因，以后可能更新不再那么频繁，但是我还是尽量做到每周更新一次。

### pk_gui.py

1. 修改同步根目录为 D:\\BackDT_sh
2. 修正子窗口弹出后会自动夺取焦点，导致无法切换到 ShadowCraft 以外窗口的 bug。
3. 在“百宝箱”中加入“生成随机选项”和“帮我选择”两个模块，原来的“执行任意指令”已被移入“高级选项”中
4. 更新“今日人品”的代码，在不同的主机/用户上显示不同的人品值
5. 调整“百宝箱”子菜单条的颜色
6. 修改部分快捷键
7. 更新“帮助”模块，现在可以指定页码了。

## pk v1.4.1（2024-08-31 发布）

### pk_gui.py

1. 更新菜单，加入“帮助”栏
2. 更新帮助页面
3. 更新菜单颜色
4. 修正一些单词拼写错误
5. 美化“解锁存档”的用户界面
6. 绑定 5 个快捷键

### pk.py

1. 现在可以自动删除存档了
2. 优化代码结构

## pk v1.4（2024-08-30 发布）

### pk_gui.py

1. 更新图标和标题
2. 更新 get_admin() 函数
3. 添加“检查管理员权限”按钮
4. 添加百宝箱
5. 加入完善日志功能
6. 直接编辑设置
7. 修复删除固定分配时，游标同步的所有文件夹对会被全部清空的 bug

### pk.py

1. 完善解锁存档功能
2. 更严格的检错机制
3. 日志记录异常

## pk 1.3.3-beta1（2024-08-27 发布）

### pk_gui.py

加入 debug 选项

### pk.py

1. 尝试删除 NTFS 权限
2. 加入“一键解锁存档”的控件
3. 在析构函数中加入记录报错日志的功能

## pk v1.3.2（2024-08-24 发布）

### pk_gui.py

1. 修正实际等待时间总是大于预期等待时间的 bug
2. 添加“日志自动滚屏（保持最后一行可见）”的功能
3. 将所有窗口都加上“自动销毁”功能
4. 修正窗口销毁后每一条日志都报 tk.TclError 错误的 bug
5. 在菜单中添加“置顶”、“保持最后一行可见” 两个选项

### pk.py

无更新

## pk v1.3.1（2024-08-23 发布）

制作 changelog.md

### pk_gui.py

1. 修复【参数】预设 /forever 时重复销毁窗口导致报错的 bug
2. 添加“获取管理员权限”按钮
3. 修改子窗口标题和图标
4. 添加 Menu 菜单

### pk.py

1. 使用更严格的 NTFS 权限设置：Everyone 拒绝完全控制（即不给任何权限）
2. 修复 1.2 版本的 bug：非管理员权限运行时会因 NTFS 权限不足而报错

## pk v1.3（2024-08-22 发布）

### pk_gui.py

添加同步列表框，可查看已添加同步的目录列表

### pk.py

1. 更新文件权限设置的代码
2. 修正文件设置 NTFS 安全权限时会递归设置的 bug
3. 检测当前运行是否为管理员权限，如没有，则自动设置

## pk v1.2（2024-08-21 发布）

### pk_gui.py

无更新

### pk.py

1. 对同步文件夹设置 只读 & 隐藏 & 系统 属性
2. 现已支持 NTFS 安全权限保护同步的 destination，~~可以在参数设置中设置是否启用~~ 目前还无法用户自行设置

## pk v1.1.1（2024-08-19 发布）

### pk_gui.py

1. 修复运行同步时窗口失去响应的 bug
2. 日志窗口添加滚动条
3. 修复 run_gui 函数在警告之前就销毁窗口的 bug
4. 移除版本混乱的 bug

### pk.py

1. 自定义等待函数
2. 自定义日志记录函数
3. 代码优化

## pk v1.1（2024-08-17 发布）

### pk_gui.py

1. 在图形界面中实时显示日志
2. 修正 “forever预设” 的配置，（delay=0.0 --> delay=1.0），减少日志写入次数
3. 解决点击红叉号关闭窗口时会报错的 bug
4. 合并 “运行（控制台）” 和 “运行（无窗口）” 两个功能
5. 显示版本号

### pk.py

1. 将 __record_ln 函数取消私有(`self.__record_ln()` --> `self.record_ln()`)
2. 显示版本号

## pkLauncher v1.0

1. 加入 GUI，文件操作，python 全面改写
2. 移除 SYNC_ROOT_FP
3. 移除对 FreeFileSync 的依赖
